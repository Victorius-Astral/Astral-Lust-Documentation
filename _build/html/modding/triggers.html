

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Triggers &mdash; Astral Lust  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/width_fix.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Characters Emotions" href="../graphics/emotions.html" />
    <link rel="prev" title="Lootlists" href="lootlists.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Astral Lust
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="get_started.html">Get Started - Astral Lust Modding</a></li>
<li class="toctree-l1"><a class="reference internal" href="cards.html">Cards</a></li>
<li class="toctree-l1"><a class="reference internal" href="dreams.html">Dreams</a></li>
<li class="toctree-l1"><a class="reference internal" href="enemies.html">Enemies</a></li>
<li class="toctree-l1"><a class="reference internal" href="lootlists.html">Lootlists</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Triggers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overwiew">Overwiew</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-a-trigger">Using a trigger</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-our-own-status-effect">Adding our own status effect</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#add-our-effect-to-the-being-eff">Add our effect, to the being.eff</a></li>
<li class="toctree-l3"><a class="reference internal" href="#program-our-effect-s-mechanic">Program our effect’s mechanic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#make-an-icon">Make an icon</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#list-of-triggers">List of triggers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#update">Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="#battle">Battle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combat">Combat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#escape">Escape</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cards">Cards</a></li>
<li class="toctree-l3"><a class="reference internal" href="#turn1">turn1()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#turn2">turn2()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#turn-dmg">turn_dmg()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#take-dmg">take_dmg()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enemy">Enemy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special">Special</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../graphics/emotions.html">Characters Emotions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelogs/modding.html">Changelog - Modding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelogs/game.html">Changelog - Game</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelogs/full.html">Changelog - Full</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelogs/debug.html">Changelog - Debug Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelogs/dreams.html">Changelog - Dreams Mode</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Astral Lust</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Triggers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modding/triggers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="triggers">
<span id="tab-triggers"></span><h1>Triggers<a class="headerlink" href="#triggers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overwiew">
<h2>Overwiew<a class="headerlink" href="#overwiew" title="Permalink to this headline">¶</a></h2>
<p>To add your own mechanics right into vanilla code without actually overwriting any files you need to use the trigger system I’ve invented for this purpose.
It takes code as string or code compiled with <code class="docutils literal notranslate"><span class="pre">compile(&quot;code&quot;,</span> <span class="pre">&quot;triggers&quot;,</span> <span class="pre">&quot;exec&quot;)</span></code>. You should compile your code at init time for increased performance.</p>
<p>Trigger system acts as a code injector, we tell it what to inject by appending our code to triggers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trigger</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;before_combat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="using-a-trigger">
<h2>Using a trigger<a class="headerlink" href="#using-a-trigger" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="adding-our-own-status-effect">
<span id="tab-triggers-effects"></span><h2>Adding our own status effect<a class="headerlink" href="#adding-our-own-status-effect" title="Permalink to this headline">¶</a></h2>
<p>Adding our own status effects comes with three steps:</p>
<ul class="simple">
<li><p>Add our effect, to the being.eff</p></li>
<li><p>Program our effect’s mechanic</p></li>
<li><p>Make an icon</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<div class="section" id="add-our-effect-to-the-being-eff">
<h3>Add our effect, to the being.eff<a class="headerlink" href="#add-our-effect-to-the-being-eff" title="Permalink to this headline">¶</a></h3>
<p>The simplest thing to do. We add <code class="docutils literal notranslate"><span class="pre">being.eff.update({&quot;SuperPower&quot;,</span> <span class="pre">&quot;Triples</span> <span class="pre">the</span> <span class="pre">damage</span> <span class="pre">dealt!&quot;})</span></code> at init time. Keep in mind that when there is a new effect, loading game will throw an error if in combat.</p>
<p>Saves inside of combat will throw an error on load without compatibility patch. Patch can be injected to <code class="docutils literal notranslate"><span class="pre">trigger.after_load_start</span></code> or <code class="docutils literal notranslate"><span class="pre">trigger.after_load_end</span></code>.
The error also will appear if loading save within combat after removing the mod. So remember to save outside of combat.</p>
<p>Saves outside of combat won’t have any problems.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">init</span> <span class="mi">11</span> <span class="n">python</span><span class="p">:</span>
  <span class="c1"># being.eff.update({&quot;Effect Name&quot;, &quot;Tooltip&quot;})</span>
  <span class="n">being</span><span class="o">.</span><span class="n">eff</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;SuperPower&quot;</span><span class="p">,</span> <span class="s2">&quot;Triples the damage dealt! Every attack uses 1 stack.&quot;</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="program-our-effect-s-mechanic">
<h3>Program our effect’s mechanic<a class="headerlink" href="#program-our-effect-s-mechanic" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">init</span> <span class="mi">11</span> <span class="n">python</span><span class="p">:</span>
  <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;if self.eff[&#39;SuperPower&#39;][0] &gt; 0: </span><span class="se">\n</span><span class="s2"> dmg = dmg * 3 </span><span class="se">\n</span><span class="s2"> self.eff[&#39;SuperPower&#39;][0] -= 1&quot;</span>
  <span class="n">com_command</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="s2">&quot;triggers&quot;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">)</span>
  <span class="n">trigger</span><span class="o">.</span><span class="n">take_dmg_before_attack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">com_command</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="make-an-icon">
<h3>Make an icon<a class="headerlink" href="#make-an-icon" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="list-of-triggers">
<h2>List of triggers<a class="headerlink" href="#list-of-triggers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="update">
<h3>Update<a class="headerlink" href="#update" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>after_load_start = [] # First thing on loading saved</p></li>
<li><p>after_load_end = [] # The end of save loading</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="battle">
<h3>Battle<a class="headerlink" href="#battle" title="Permalink to this headline">¶</a></h3>
<p># fight() function - initialization of combat #
* start_of_fight = [] # The start of fight() function
* middle_of_fight = [] # Middle of fight() function, before defining piles
* before_combat_screen = [] # Before combat screens are initialized
* before_combat = [] # Right before actual combat starts</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="combat">
<h3>Combat<a class="headerlink" href="#combat" title="Permalink to this headline">¶</a></h3>
<p>End turn order:</p>
<ul class="simple">
<li><p>player turn damage</p></li>
<li><p>enemy turn damage</p></li>
<li><p>enemy turn1</p></li>
<li><p>enemy action</p></li>
<li><p>enemy turn2</p></li>
<li><p>player turn2</p></li>
<li><p>player turn1</p></li>
<li><p>before_discard = [] # Before cards are discarded from hand</p></li>
<li><p>after_discard = [] # After cards been discarded, before other things</p></li>
<li><p>after_turn_damage = [] # After calculating damage from effects</p></li>
<li><p>before_enemy_action = [] # Before enemy makes an action</p></li>
<li><p>after_enemy_action = [] # After enemy makes an action</p></li>
<li><p>after_decrease_effects = [] # After turn2() (effects decrease)</p></li>
<li><p>before_new_turn = [] # Right before new turn</p></li>
<li><p>before_new_turn_alt = [] # Right before new turn, screen isn’t blocked</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="escape">
<h3>Escape<a class="headerlink" href="#escape" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>on_escape = [] # When trying to escape combat</p></li>
<li><p>on_escape_success = [] # When succed in escape roll, before actual escape</p></li>
<li><p>on_escape_fail = [] # When failed to escape</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="cards">
<h3>Cards<a class="headerlink" href="#cards" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>card_use = [] # On using a card, before anything else</p></li>
<li><p>card_before_play = [] # Right before card is played</p></li>
<li><p>card_after_play = [] # Right after card is played</p></li>
<li><p>card_after_use = [] # After all cards interactions are done</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="turn1">
<h3>turn1()<a class="headerlink" href="#turn1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>turn1_start = [] # Beginning of turn1</p></li>
<li><p>turn1_end = [] # End of turn1</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="turn2">
<h3>turn2()<a class="headerlink" href="#turn2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>turn2_start = [] # Beginning of turn2</p></li>
<li><p>turn2_end = [] # End of turn2</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="turn-dmg">
<h3>turn_dmg()<a class="headerlink" href="#turn-dmg" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>turn_dmg_start = [] # Beginning of turn_dmg</p></li>
<li><p>turn_dmg_end = [] # End of turn_dmg</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="take-dmg">
<h3>take_dmg()<a class="headerlink" href="#take-dmg" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>take_dmg_start = [] # Beginning of take_dmg, after is_player is defined, it can be used to check if executed by player or enemy</p></li>
<li><p>take_dmg_before_attack = [] # Right before damage is dealt</p></li>
<li><p>take_dmg_after_attack = [] # Right after damage is dealt</p></li>
<li><p>take_dmg_end = [] # End of take_dmg</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="enemy">
<h3>Enemy<a class="headerlink" href="#enemy" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>enemy_atk_start = [] # Beginning of atk method</p></li>
<li><p>enemy_before_attack = [] # Right before damage is dealt (before player.take_dmg(dmg) is called)</p></li>
<li><p>enemy_after_attack = [] # Right before damage is dealt (before player.take_dmg(dmg) is called)</p></li>
<li><p>enemy_atk_end = [] # End of atk method</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="special">
<h3>Special<a class="headerlink" href="#special" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>test = [“print(‘TEST’)”] # Used with</p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../graphics/emotions.html" class="btn btn-neutral float-right" title="Characters Emotions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="lootlists.html" class="btn btn-neutral float-left" title="Lootlists" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Victorius.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>